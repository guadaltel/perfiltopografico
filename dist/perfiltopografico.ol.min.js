!function(t){var e={};function o(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,o),i.l=!0,i.exports}o.m=t,o.c=e,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)o.d(n,i,function(e){return t[e]}.bind(null,i));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=3)}([function(t,e){t.exports='<div class="m-perfilestopograficos">\r\n    <button id="m-dibujar-button" class="g-cartografia-ruta" title="Dibujar tramo"></button>\r\n    <button id="m-grafica-button" class="g-cartografia-info" title="Mostrar/Ocultar perfil del tramo"></button>\r\n    <button id="m-borrar-button" class="g-cartografia-papelera" title="Eliminar"></button>\r\n</div>'},function(t){t.exports=JSON.parse('{"url":{"name":"Perfiltopografico","separator":"*"},"constructor":"M.plugin.Perfiltopografico","parameters":[{"type":"object","properties":[{"type":"simple","name":"distance","position":0},{"type":"simple","name":"serviceURL","position":1}]}],"files":{"ol":{"scripts":["perfiltopografico.ol.min.js"],"styles":["perfiltopografico.ol.min.css"]}},"metadata":{"name":"Perfil Topográfico","description":"Genera un perfil longitudinal","text":"A partir de un eje dibujado, el plugin muestra un perfil longitudinal del terreno","version":"1.0.0","date":"Enero, 2020","author":"","org":"","tags":"mapea,plugin","icon":"./facade/assets/icons/icons.svg"}}')},function(t,e,o){},function(t,e,o){"use strict";o.r(e);o(2);var n,i,r={zmin:"Zmin",zmax:"Zmax",ytitle:"Altitude (m)",xtitle:"Distance (km)",time:"Time",altitude:"Altitude",distance:"Distance",altitudeUnits:"m",distanceUnitsM:"m",distanceUnitsKM:"km"},a=function(t){var e=t||{};this.info=e.info||r;var o,n=this;if(e.target)(o=document.createElement("div")).classList.add(e.className||"ol-profil");else{(o=document.createElement("div")).className=((e.className||"ol-profil")+" ol-unselectable ol-control ol-collapsed").trim();var i=document.createElement("p");i.textContent="Perfil Topográfico",o.appendChild(i)}var a=document.createElement("div");a.classList.add("ol-inner"),o.appendChild(a);var s=document.createElement("div");s.style.position="relative",a.appendChild(s);var l=this.ratio=2;this.canvas_=document.createElement("canvas"),this.canvas_.width=(e.width||300)*l,this.canvas_.height=(e.height||150)*l;var c={msTransform:"scale(0.5,0.5)",msTransformOrigin:"0 0",webkitTransform:"scale(0.5,0.5)",webkitTransformOrigin:"0 0",mozTransform:"scale(0.5,0.5)",mozTransformOrigin:"0 0",transform:"scale(0.5,0.5)",transformOrigin:"0 0"};Object.keys(c).forEach((function(t){t in n.canvas_.style&&(n.canvas_.style[t]=c[t])}));var u=document.createElement("div");s.appendChild(u),u.style.width=this.canvas_.width/l+"px",u.style.height=this.canvas_.height/l+"px",u.appendChild(this.canvas_),u.addEventListener("click",(function(t){n.onMove(t)})),u.addEventListener("mousemove",(function(t){n.onMove(t)})),ol.control.Control.call(this,{element:o,target:e.target}),this.margin_={top:10*l,left:40*l,bottom:30*l,right:10*l},this.info.ytitle||(this.margin_.left-=20*l),this.info.xtitle||(this.margin_.bottom-=20*l),this.bar_=document.createElement("div"),this.bar_.classList.add("ol-profilbar"),this.bar_.style.top=this.margin_.top/l+"px",this.bar_.style.height=(this.canvas_.height-this.margin_.top-this.margin_.bottom)/l+"px",s.appendChild(this.bar_),this.cursor_=document.createElement("div"),this.cursor_.classList.add("ol-profilcursor"),s.appendChild(this.cursor_),this.popup_=document.createElement("div"),this.popup_.classList.add("ol-profilpopup"),this.cursor_.appendChild(this.popup_);var p=document.createElement("table");p.cellPadding="0",p.cellSpacing="0",p.style.clientWidth=this.canvas_.width/l+"px",s.appendChild(p);var f=document.createElement("tr");f.classList.add("track-info"),p.appendChild(f);var d=document.createElement("td");d.innerHTML=(this.info.zmin||"Zmin")+': <span class="zmin">',f.appendChild(d);var h=document.createElement("td");h.innerHTML=(this.info.zmax||"Zmax")+': <span class="zmax">',f.appendChild(h);var m=document.createElement("td");m.innerHTML=(this.info.distance||"Distance")+': <span class="dist">',f.appendChild(m);var y=document.createElement("tr");y.classList.add("point-info"),p.appendChild(y);var _=document.createElement("td");_.innerHTML=(this.info.altitude||"Altitude")+': <span class="z">',y.appendChild(_);var v=document.createElement("td");v.innerHTML='Dist. parcial: <span class="dist">',y.appendChild(v);var g=document.createElement("td");g.innerHTML=(this.info.time||"Time")+': <span class="time">',y.appendChild(g),this.tab_=[],e.feature&&this.setGeometry(e.feature)};n=a,i=ol.control.Control,n.prototype=Object.create(i.prototype),n.prototype.constructor=n,a.prototype.popup=function(t){this.popup_.innerHTML=t},a.prototype.onMove=function(t){if(this.tab_.length){var e=this.canvas_.getBoundingClientRect(),o=e.top+window.pageYOffset-document.documentElement.clientTop,n=e.left+window.pageXOffset-document.documentElement.clientLeft,i=t.pageX-n,r=t.pageY-o,a=this.ratio;if(i>this.margin_.left/a&&i<(this.canvas_.width-this.margin_.right)/a&&r>this.margin_.top/a&&r<(this.canvas_.height-this.margin_.bottom)/a){this.bar_.style.left=i+"px",this.bar_.style.display="block";for(var s,l=(i*a-this.margin_.left)/this.scale_[0],c=this.tab_[0],u=1;s=this.tab_[u];u++)if(s[0]>=l){l<(s[0]+c[0])/2&&(s=c);break}s?(this.cursor_.style.left=i+"px",this.cursor_.style.top=(this.canvas_.height-this.margin_.bottom+s[1]*this.scale_[1]+this.dy_)/a+"px",this.cursor_.style.display="block"):this.cursor_.style.display="none",this.bar_.parentElement.classList.add("over"),this.element.querySelector(".point-info .z").textContent=s[1]+this.info.altitudeUnits,this.element.querySelector(".point-info .dist").textContent=(s[0]/1e3).toFixed(1)+this.info.distanceUnitsKM,this.element.querySelector(".point-info .time").textContent=s[2],i>this.canvas_.width/a/2?this.popup_.classList.add("ol-left"):this.popup_.classList.remove("ol-left"),this.dispatchEvent({type:"over",click:"click"==t.type,coord:s[3],time:s[2],distance:s[0]})}else this.bar_.parentElement.classList.contains("over")&&(this.bar_.style.display="none",this.cursor_.style.display="none",this.bar_.parentElement.classList.remove("over"),this.dispatchEvent({type:"out"}))}},a.prototype.show=function(){this.element.classList.remove("ol-collapsed"),this.dispatchEvent({type:"show",show:!0})},a.prototype.hide=function(){this.element.classList.add("ol-collapsed"),this.dispatchEvent({type:"show",show:!1})},a.prototype.toggle=function(){this.element.classList.toggle("ol-collapsed");var t=this.element.classList.contains("ol-collapsed");this.dispatchEvent({type:"show",show:!t})},a.prototype.isShown=function(){return!this.element.classList.contains("ol-collapsed")},a.prototype.setGeometry=function(t,e){e||(e={}),t instanceof ol.Feature&&(t=t.getGeometry());var o=this.canvas_,n=o.getContext("2d"),i=o.width,r=o.height;if(n.setTransform(1,0,0,1,0,0),n.clearRect(0,0,i,r),/Z/.test(t.getLayout())){/M/.test(t.getLayout())?this.element.querySelector(".time").parentElement.style.display="block":this.element.querySelector(".time").parentElement.style.display="none";var a=t.getCoordinates();switch(t.getType()){case"LineString":break;case"MultiLineString":a=a[0];break;default:return}var s=e.projection||this.getMap().getView().getProjection();n.setTransform(1,0,0,1,this.margin_.left,r-this.margin_.bottom);var l=this.ratio;i-=this.margin_.right+this.margin_.left,r-=this.margin_.top+this.margin_.bottom,n.strokeStyle="#000",n.lineWidth=.5*l,n.beginPath(),n.moveTo(0,0),n.lineTo(0,-r),n.moveTo(0,0),n.lineTo(i,0),n.stroke();var c,u,p,f,d,h,m,y=1/0,_=-1/0,v=this.tab_=[];for(c=0;u=a[c];c++)(f=u[2])<y&&(y=f),f>_&&(_=f),0==c?p=0:p+=(h=a[c-1],m=u,ol.sphere.getDistance(ol.proj.transform(h,s,"EPSG:4326"),ol.proj.transform(m,s,"EPSG:4326"))),d=x(a[0][3],u[3]),v.push([p,f,d,u]);this.element.querySelector(".track-info .zmin").textContent=y.toFixed(2)+this.info.altitudeUnits,this.element.querySelector(".track-info .zmax").textContent=_.toFixed(2)+this.info.altitudeUnits,this.element.querySelector(".track-info .dist").textContent=p>1e3?(p/1e3).toFixed(1)+this.info.distanceUnitsKM:p.toFixed(1)+this.info.distanceUnitsM;for(var g=e.graduation||100;;){if(!(r/(((_=Math.ceil(_/g)*g)-(y=Math.floor(y/g)*g))/g)<15*l))break;g*=2}"number"==typeof e.zmin&&y>e.zmin&&(y=e.zmin),"number"==typeof e.zmax&&_<e.zmax&&(_=e.zmax);var b=e.amplitude;b&&(_=Math.max(y+b,_));var w=i/p,M=-r/(_-y),P=this.dy_=-y*M;for(this.scale_=[w,M],n.font=10*l+"px arial",n.textAlign="right",n.textBaseline="middle",n.fillStyle="#000",n.beginPath(),c=y;c<=_;c+=g)"km"!=e.zunit?n.fillText(c,-4*l,c*M+P):n.fillText((c/1e3).toFixed(1),-4*l,c*M+P),n.moveTo(-2*l,c*M+P),0!=c?n.lineTo(p*w,c*M+P):n.lineTo(0,c*M+P);n.textAlign="center",n.textBaseline="top",n.setLineDash([l,3*l]);var S,L=e.unit||"km";for(p>1e3?(S=100*Math.round(p/1e3))>1e3&&(S=1e3*Math.ceil(S/1e3)):(L="m",S=p>100?10*Math.round(p/100):p>10?Math.round(p/10):p>1?Math.round(p)/10:p),c=0;c<=p;c+=S){var j="m"==L?c:c/1e3;n.fillText(Math.round(10*j)/10,c*w,4*l),n.moveTo(c*w,2*l),n.lineTo(c*w,0)}for(n.font=12*l+"px arial",n.fillText(this.info.xtitle.replace("(km)","("+L+")"),i/2,18*l),n.save(),n.rotate(-Math.PI/2),n.fillText(this.info.ytitle,r/2,-this.margin_.left),n.restore(),n.stroke(),n.strokeStyle="#368",n.lineWidth=3,n.setLineDash([]),n.beginPath(),c=0;u=v[c];c++)0==c?n.moveTo(u[0]*w,u[1]*M+P):n.lineTo(u[0]*w,u[1]*M+P);n.stroke()}function x(t,e){if(!t||!e)return"-";var o=(e-t)/60,n=Math.trunc(o/60),i=Math.trunc(o-60*n);return n+"h"+(i<10?"0":"")+i+"mn"}},a.prototype.getImage=function(t,e){return"canvas"===t?this.canvas_:this.canvas_.toDataURL(t,e)};var s=a;function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function c(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function u(t,e){return!e||"object"!==l(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function p(t,e,o){return(p="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,o){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=f(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(o):i.value}})(t,e,o||t)}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function d(t,e){return(d=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var h=function(t){function e(t){var o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o=u(this,f(e).call(this));var n=[t.distance,"EPSG:900913",t.serviceURL,"EPSG:4326"];o.distancePoinst_=n[0],o.mercator_=n[1],o.serviceURL=n[2],o.coordEPSG4326=n[3];var i=[null,null,null,null,null,null,null,null,null,null,null,null];o.projectionMap_=i[0],o.profil_=i[1],o.facadeMap_=i[2],o.vector_=i[3],o.source_=i[4],o.vectorProfile_=i[5],o.sourceProfile_=i[6],o.draw_=i[7],o.lineCoord_=i[8],o.pointsCoord_=i[9],o.dataPoints_=i[10],o.pt=i[11];var r=[null,null,null];return o.lineString_=r[0],o.feature_=r[1],o.style_=r[2],o}var o,n,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&d(t,e)}(e,M.impl.Control),o=e,(n=[{key:"addTo",value:function(t,o){this.facadeMap_=t,this.initOlLayers(),p(f(e.prototype),"addTo",this).call(this,t,o)}},{key:"initOlLayers",value:function(){this.style_=function(t){return"LineString"==t.getGeometry().getType()?[new ol.style.Style({stroke:new ol.style.Stroke({color:"#4286f4",width:2})})]:[new ol.style.Style({image:new ol.style.Circle({radius:6,fill:new ol.style.Fill({color:"#4286f4"})}),stroke:new ol.style.Stroke({color:"#4286f4",width:2}),fill:new ol.style.Fill({color:"#4286f4"})})]},this.source_=new ol.source.Vector({wrapX:!1}),this.vector_=new ol.layer.Vector({source:this.source_,style:this.style_,name:"capatopo"}),this.sourceProfile_=new ol.source.Vector,this.vectorProfile_=new ol.layer.Vector({source:this.sourceProfile_}),this.vector_.setZIndex(1e3),this.facadeMap_.getMapImpl().addLayer(this.vector_),this.projectionMap_=this.facadeMap_.getProjection().code}},{key:"findNewPoints",value:function(t,e){var o,n,i=new String,r=ol.proj.transform(t,this.projectionMap_,this.mercator_),a=ol.proj.transform(e,this.projectionMap_,this.mercator_),s=this.getAngleBetweenPoints(r,a),l=this.getDistBetweenPoints(t,e);if(!(l<50)){for(var c=l/this.distancePoinst_>this.distancePoinst_?l/this.distancePoinst_:this.distancePoinst_,u=0;u<=l/c;u++){s>=0&&s<=90?(o=1,n=1):s>=90?(o=-1,n=1):s<=0&&s>=-90?(o=1,n=-1):(o=-1,n=-1);var p=[Math.cos(s*Math.PI/180)*(c*u)+r[0],Math.sin(s*Math.PI/180)*(c*u)+r[1]],f=[Math.cos(s*Math.PI/180)*(c*u+o)+r[0],Math.sin(s*Math.PI/180)*(c*u+n)+r[1]];i+=ol.proj.transform(p,this.mercator_,this.coordEPSG4326)+",",i+=ol.proj.transform(f,this.mercator_,this.coordEPSG4326)+"|"}return i}}},{key:"getDistBetweenPoints",value:function(t,e){return new ol.geom.LineString([ol.proj.transform(t,this.projectionMap_,this.mercator_),ol.proj.transform(e,this.projectionMap_,this.mercator_)]).getLength()}},{key:"getAngleBetweenPoints",value:function(t,e){var o=t[0],n=t[1],i=e[0],r=e[1];return 180*Math.atan2(r-n,i-o)/Math.PI}},{key:"startLoad",value:function(){document.body.style.cursor="wait",this.deactivate(),document.querySelector(".m-perfilestopograficos.activated").style.pointerEvents="none"}},{key:"endLoad",value:function(){document.body.style.cursor="default",this.activate(),document.querySelector(".m-perfilestopograficos.activated").style.pointerEvents="auto"}},{key:"activate",value:function(){this.draw_||this.createIteraction("LineString"),this.facadeMap_.getMapImpl().addInteraction(this.draw_)}},{key:"createIteraction",value:function(t){this.draw_=new ol.interaction.Draw({source:this.source_,type:t}),this.draw_.on("drawstart",function(t){this.projectionMap_=this.facadeMap_.getProjection().code,this.clearLayer()}.bind(this)),this.draw_.on("drawend",function(t){this.lineCoord_=t.feature.getGeometry().getCoordinates(),this.facadeMap_.getMapImpl().addInteraction(this.draw_),this.pointsCoord_=new String;for(var e=1;e<this.lineCoord_.length;e++)this.pointsCoord_=this.pointsCoord_.concat(this.findNewPoints(this.lineCoord_[e-1],this.lineCoord_[e]));this.getDataFromGGISCore()}.bind(this))}},{key:"getDataFromGGISCore",value:function(){var t=this;if(this.pointsCoord_){this.pointsCoord_=this.pointsCoord_.replace(new RegExp(",","g")," ");var e=this.serviceURL,o=M.utils.addParameters(e,{_:M.utils.generateRandom()});new Promise((function(e,n){M.proxy(!1),t.startLoad();var i=new XMLHttpRequest;i.open("POST",o,!0),i.onreadystatechange=function(t){i.readyState==XMLHttpRequest.DONE&&200==i.status?e(i.response):i.readyState==XMLHttpRequest.DONE&&200!=i.status&&(this.endLoad(),M.dialog.info("No se han obtenido datos."))}.bind(t),i.setRequestHeader("Accept","application/json"),i.setRequestHeader("Content-Type","application/json"),i.send(JSON.stringify({data:t.pointsCoord_}))})).then(function(t){var e=this;M.proxy(!0),this.endLoad();var o=JSON.parse(t);if(o.length>0){var n=new Array;o.forEach((function(t){n.push([parseFloat(t.coord[0]),parseFloat(t.coord[1]),t.elevation])})),this.controlProfile();var i=n.map((function(t){return ol.proj.transform(t,"EPSG:4326",e.facadeMap_.getProjection().code)}));this.lineString_.setCoordinates(i)}else M.dialog.info("No se han obtenido datos")}.bind(this))}}},{key:"controlProfile",value:function(){if(!this.profil_){this.lineString_=new ol.geom.LineString([]),this.feature_=new ol.Feature({geometry:this.lineString_,name:"Line"}),this.sourceProfile_.addFeature(this.feature_),this.profil_=new s({info:{zmin:"Alt. min",zmax:"Alt. max",altitude:"Altitud",distance:"Dist. total",ytitle:"Altitud (m)",xtitle:"Distancia (km)",altitudeUnits:"m",distanceUnitsM:"m",distanceUnitsKM:"km"},projection:this.facadeMap_.getProjection().code}),this.facadeMap_.getMapImpl().addControl(this.profil_);var t=function(t){this.pt&&("over"==t.type?(this.pt.setGeometry(new ol.geom.Point(t.coord)),this.pt.setStyle(null)):this.pt.setStyle([]))}.bind(this);this.sourceProfile_.once("change",function(t){"ready"===this.sourceProfile_.getState()&&(this.profil_.setGeometry(this.sourceProfile_.getFeatures()[0]),this.pt=new ol.Feature(new ol.geom.Point([0,0])),this.pt.setStyle([]),this.source_.addFeature(this.pt))}.bind(this)),this.profil_.on(["over","out"],function(e){"over"==e.type&&this.profil_.popup(e.coord[2]+" m"),t(e)}.bind(this))}this.profil_.show()}},{key:"deactivate",value:function(){this.draw_&&this.facadeMap_.getMapImpl().removeInteraction(this.draw_)}},{key:"clearLayer",value:function(){this.source_.clear(),this.profil_&&(this.profil_.hide(),this.sourceProfile_.clear(),this.facadeMap_.getMapImpl().removeControl(this.profil_),this.profil_=null)}},{key:"removeLayer",value:function(){this.deactivate(),this.clearLayer(),this.facadeMap_.getMapImpl().removeLayer(this.vector_)}},{key:"destroy",value:function(){this.removeLayer(),this.facadeMap_.getMapImpl().removeControl(this)}},{key:"toggle",value:function(){this.profil_&&this.profil_.toggle()}}])&&c(o.prototype,n),i&&c(o,i),e}(),m=o(0),y=o.n(m);function _(t){return(_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function v(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function g(t,e){return!e||"object"!==_(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function b(t,e,o){return(b="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,o){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=w(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(o):i.value}})(t,e,o||t)}function w(t){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function P(t,e){return(P=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var S=function(t){function e(t){var o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),M.utils.isUndefined(h)&&M.exception("La implementación usada no puede crear controles PerfiltopograficoControl");var n=new h(t),i=[null,null,null,null,null,n,t];return(o=g(this,w(e).call(this,n,"Perfiltopografico"))).btnDraw_=i[0],o.btnData_=i[1],o.btnRemove_=i[2],o.facadeMap_=i[3],o.html_=i[4],o.drawCtrl_=i[5],o.opts=i[6],o}var o,n,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&P(t,e)}(e,M.Control),o=e,(n=[{key:"createView",value:function(t){var e=this;return M.template.compileSync||(M.template.compileSync=function(t,e){var o,n={};M.utils.isUndefined(e)||(n=M.utils.extends(n,e.vars),o=e.parseToHtml);var i=Handlebars.compile(t)(n);return!1!==o?M.utils.stringToHtml(i):i}),this.facadeMap_=t,document.querySelector("div.m-panel.m-perfilestopograficos>button.m-panel-btn").title="Topografía",new Promise((function(t,o){var n=M.template.compileSync(y.a);e.template_=n,e.btnDraw_=n.querySelector("#m-dibujar-button"),e.btnData_=n.querySelector("#m-grafica-button"),e.btnRemove_=n.querySelector("#m-borrar-button"),t(n),e.btnData_.addEventListener("click",(function(t){return e.mostrar(t)})),e.btnRemove_.addEventListener("click",(function(t){return e.actionRemove(t)}))}))}},{key:"actionRemove",value:function(t){this.drawCtrl_.clearLayer(),this.deactivate()}},{key:"mostrar",value:function(){this.drawCtrl_.toggle()}},{key:"getActivationButton",value:function(t){return t.querySelector(".m-perfilestopograficos button")}},{key:"deactivate",value:function(){b(w(e.prototype),"deactivate",this).call(this)}},{key:"equals",value:function(t){return t instanceof e}}])&&v(o.prototype,n),i&&v(o,i),e}(),L=o(1);function j(t){return(j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function x(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function C(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function k(t,e){return!e||"object"!==j(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function E(t){return(E=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function O(t,e){return(O=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var T=function(t){function e(){var t,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return x(this,e),(t=k(this,E(e).call(this))).map_=null,t.controls_=[],t.metadata_=L.metadata,t.facadeMap_=null,t.panel_=null,t.control_=null,t.options_=o,t.options_.distance=o.distance||30,t.options_.serviceURL=o.serviceURL||(M.config.GGIS_RESTAPI?M.config.GGIS_RESTAPI+"/services/elevation":"http://ggiscloud.guadaltel.com/ggiscloud/restapi/services/elevation"),t}var o,n,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&O(t,e)}(e,M.Plugin),o=e,(n=[{key:"addTo",value:function(t){this.controls_.push(new S(this.options_)),this.map_=t,this.panel_=new M.ui.Panel("panelPerfiltopografico",{collapsible:!0,className:"m-perfilestopograficos",collapsedButtonClass:"g-grafica-puntos2",position:M.ui.position.TR,tooltip:this.name}),this.panel_.addControls(this.controls_),t.addPanels(this.panel_)}},{key:"getMetadata",value:function(){return this.metadata_}},{key:"destroy",value:function(){this.map_.removeControls(this.controls_);var t=[null,null,null];this.map_=t[0],this.controls_=t[1],this.panel_=t[2]}},{key:"name",get:function(){return"Perfil Topográfico"}}])&&C(o.prototype,n),i&&C(o,i),e}();window.M.plugin||(window.M.plugin={}),window.M.control||(window.M.control={}),window.M.impl||(window.M.impl={}),window.M.impl.control||(window.M.impl.control={}),window.M.plugin.Perfiltopografico=T,window.M.control.PerfiltopograficoControl=S,window.M.impl.control.PerfiltopograficoControl=h}]);
//# sourceMappingURL=perfiltopografico.ol.min.js.map